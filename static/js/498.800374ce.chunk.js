"use strict";(self.webpackChunkexcel_viewer=self.webpackChunkexcel_viewer||[]).push([[498],{3498:(e,t,l)=>{l.d(t,{CellDetailModal:()=>_});var n=l(9950),a=l(5355),c=l(9654),o=l(1122),s=l(8738),i=l.n(s),r=l(6191),d=l(5741),m=l(9415),b=l(6661);const p={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1},v=n.createContext({});var h=l(604),u=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(l[n[a]]=e[n[a]])}return l};function g(e,t,l){const a=n.useMemo(()=>{return t||(e=l,(0,h.A)(e).map(e=>Object.assign(Object.assign({},null===e||void 0===e?void 0:e.props),{key:e.key})));var e},[t,l]);return n.useMemo(()=>a.map(t=>{var{span:l}=t,n=u(t,["span"]);return"filled"===l?Object.assign(Object.assign({},n),{filled:!0}):Object.assign(Object.assign({},n),{span:"number"===typeof l?l:(0,r.ko)(e,l)})}),[a,e])}var j=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(l[n[a]]=e[n[a]])}return l};const y=(e,t)=>{const[l,a]=(0,n.useMemo)(()=>function(e,t){let l=[],n=[],a=!1,c=0;return e.filter(e=>e).forEach(e=>{const{filled:o}=e,s=j(e,["filled"]);if(o)return n.push(s),l.push(n),n=[],void(c=0);const i=t-c;c+=e.span||1,c>=t?(c>t?(a=!0,n.push(Object.assign(Object.assign({},s),{span:i}))):n.push(s),l.push(n),n=[],c=0):n.push(s)}),n.length>0&&l.push(n),l=l.map(e=>{const l=e.reduce((e,t)=>e+(t.span||1),0);if(l<t){const n=e[e.length-1];return n.span=t-(l-(n.span||1)),e}return e}),[l,a]}(t,e),[t,e]);return l},x=e=>{let{children:t}=e;return t};function f(e){return void 0!==e&&null!==e}const O=e=>{const{itemPrefixCls:t,component:l,span:a,className:c,style:o,labelStyle:s,contentStyle:r,bordered:d,label:m,content:b,colon:p,type:h,styles:u}=e,g=l,j=n.useContext(v),{classNames:y}=j;return d?n.createElement(g,{className:i()({["".concat(t,"-item-label")]:"label"===h,["".concat(t,"-item-content")]:"content"===h,["".concat(null===y||void 0===y?void 0:y.label)]:"label"===h,["".concat(null===y||void 0===y?void 0:y.content)]:"content"===h},c),style:o,colSpan:a},f(m)&&n.createElement("span",{style:Object.assign(Object.assign({},s),null===u||void 0===u?void 0:u.label)},m),f(b)&&n.createElement("span",{style:Object.assign(Object.assign({},s),null===u||void 0===u?void 0:u.content)},b)):n.createElement(g,{className:i()("".concat(t,"-item"),c),style:o,colSpan:a},n.createElement("div",{className:"".concat(t,"-item-container")},(m||0===m)&&n.createElement("span",{className:i()("".concat(t,"-item-label"),null===y||void 0===y?void 0:y.label,{["".concat(t,"-item-no-colon")]:!p}),style:Object.assign(Object.assign({},s),null===u||void 0===u?void 0:u.label)},m),(b||0===b)&&n.createElement("span",{className:i()("".concat(t,"-item-content"),null===y||void 0===y?void 0:y.content),style:Object.assign(Object.assign({},r),null===u||void 0===u?void 0:u.content)},b)))};function w(e,t,l){let{colon:a,prefixCls:c,bordered:o}=t,{component:s,type:i,showLabel:r,showContent:d,labelStyle:m,contentStyle:b,styles:p}=l;return e.map((e,t)=>{let{label:l,children:v,prefixCls:h=c,className:u,style:g,labelStyle:j,contentStyle:y,span:x=1,key:f,styles:w}=e;return"string"===typeof s?n.createElement(O,{key:"".concat(i,"-").concat(f||t),className:u,style:g,styles:{label:Object.assign(Object.assign(Object.assign(Object.assign({},m),null===p||void 0===p?void 0:p.label),j),null===w||void 0===w?void 0:w.label),content:Object.assign(Object.assign(Object.assign(Object.assign({},b),null===p||void 0===p?void 0:p.content),y),null===w||void 0===w?void 0:w.content)},span:x,colon:a,component:s,itemPrefixCls:h,bordered:o,label:r?l:null,content:d?v:null,type:i}):[n.createElement(O,{key:"label-".concat(f||t),className:u,style:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},m),null===p||void 0===p?void 0:p.label),g),j),null===w||void 0===w?void 0:w.label),span:1,colon:a,component:s[0],itemPrefixCls:h,bordered:o,label:l,type:"label"}),n.createElement(O,{key:"content-".concat(f||t),className:u,style:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},b),null===p||void 0===p?void 0:p.content),g),y),null===w||void 0===w?void 0:w.content),span:2*x-1,component:s[1],itemPrefixCls:h,bordered:o,content:v,type:"content"})]})}const S=e=>{const t=n.useContext(v),{prefixCls:l,vertical:a,row:c,index:o,bordered:s}=e;return a?n.createElement(n.Fragment,null,n.createElement("tr",{key:"label-".concat(o),className:"".concat(l,"-row")},w(c,e,Object.assign({component:"th",type:"label",showLabel:!0},t))),n.createElement("tr",{key:"content-".concat(o),className:"".concat(l,"-row")},w(c,e,Object.assign({component:"td",type:"content",showContent:!0},t)))):n.createElement("tr",{key:o,className:"".concat(l,"-row")},w(c,e,Object.assign({component:s?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},t)))};var N=l(7864),C=l(5343),k=l(1900),E=l(9642);const z=e=>{const{componentCls:t,labelBg:l}=e;return{["&".concat(t,"-bordered")]:{["> ".concat(t,"-view")]:{border:"".concat((0,N.zA)(e.lineWidth)," ").concat(e.lineType," ").concat(e.colorSplit),"> table":{tableLayout:"auto"},["".concat(t,"-row")]:{borderBottom:"".concat((0,N.zA)(e.lineWidth)," ").concat(e.lineType," ").concat(e.colorSplit),"&:first-child":{"> th:first-child, > td:first-child":{borderStartStartRadius:e.borderRadiusLG}},"&:last-child":{borderBottom:"none","> th:first-child, > td:first-child":{borderEndStartRadius:e.borderRadiusLG}},["> ".concat(t,"-item-label, > ").concat(t,"-item-content")]:{padding:"".concat((0,N.zA)(e.padding)," ").concat((0,N.zA)(e.paddingLG)),borderInlineEnd:"".concat((0,N.zA)(e.lineWidth)," ").concat(e.lineType," ").concat(e.colorSplit),"&:last-child":{borderInlineEnd:"none"}},["> ".concat(t,"-item-label")]:{color:e.colorTextSecondary,backgroundColor:l,"&::after":{display:"none"}}}},["&".concat(t,"-middle")]:{["".concat(t,"-row")]:{["> ".concat(t,"-item-label, > ").concat(t,"-item-content")]:{padding:"".concat((0,N.zA)(e.paddingSM)," ").concat((0,N.zA)(e.paddingLG))}}},["&".concat(t,"-small")]:{["".concat(t,"-row")]:{["> ".concat(t,"-item-label, > ").concat(t,"-item-content")]:{padding:"".concat((0,N.zA)(e.paddingXS)," ").concat((0,N.zA)(e.padding))}}}}}},A=(0,k.OF)("Descriptions",e=>(e=>{const{componentCls:t,extraColor:l,itemPaddingBottom:n,itemPaddingEnd:a,colonMarginRight:c,colonMarginLeft:o,titleMarginBottom:s}=e;return{[t]:Object.assign(Object.assign(Object.assign({},(0,C.dF)(e)),z(e)),{"&-rtl":{direction:"rtl"},["".concat(t,"-header")]:{display:"flex",alignItems:"center",marginBottom:s},["".concat(t,"-title")]:Object.assign(Object.assign({},C.L9),{flex:"auto",color:e.titleColor,fontWeight:e.fontWeightStrong,fontSize:e.fontSizeLG,lineHeight:e.lineHeightLG}),["".concat(t,"-extra")]:{marginInlineStart:"auto",color:l,fontSize:e.fontSize},["".concat(t,"-view")]:{width:"100%",borderRadius:e.borderRadiusLG,table:{width:"100%",tableLayout:"fixed",borderCollapse:"collapse"}},["".concat(t,"-row")]:{"> th, > td":{paddingBottom:n,paddingInlineEnd:a},"> th:last-child, > td:last-child":{paddingInlineEnd:0},"&:last-child":{borderBottom:"none","> th, > td":{paddingBottom:0}}},["".concat(t,"-item-label")]:{color:e.labelColor,fontWeight:"normal",fontSize:e.fontSize,lineHeight:e.lineHeight,textAlign:"start","&::after":{content:'":"',position:"relative",top:-.5,marginInline:"".concat((0,N.zA)(o)," ").concat((0,N.zA)(c))},["&".concat(t,"-item-no-colon::after")]:{content:'""'}},["".concat(t,"-item-no-label")]:{"&::after":{margin:0,content:'""'}},["".concat(t,"-item-content")]:{display:"table-cell",flex:1,color:e.contentColor,fontSize:e.fontSize,lineHeight:e.lineHeight,wordBreak:"break-word",overflowWrap:"break-word"},["".concat(t,"-item")]:{paddingBottom:0,verticalAlign:"top","&-container":{display:"flex",["".concat(t,"-item-label")]:{display:"inline-flex",alignItems:"baseline"},["".concat(t,"-item-content")]:{display:"inline-flex",alignItems:"baseline",minWidth:"1em"}}},"&-middle":{["".concat(t,"-row")]:{"> th, > td":{paddingBottom:e.paddingSM}}},"&-small":{["".concat(t,"-row")]:{"> th, > td":{paddingBottom:e.paddingXS}}}})}})((0,E.oX)(e,{})),e=>({labelBg:e.colorFillAlter,labelColor:e.colorTextTertiary,titleColor:e.colorText,titleMarginBottom:e.fontSizeSM*e.lineHeightSM,itemPaddingBottom:e.padding,itemPaddingEnd:e.padding,colonMarginRight:e.marginXS,colonMarginLeft:e.marginXXS/2,contentColor:e.colorText,extraColor:e.colorText}));var B=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(l[n[a]]=e[n[a]])}return l};const I=e=>{const{prefixCls:t,title:l,extra:a,column:c,colon:o=!0,bordered:s,layout:h,children:u,className:j,rootClassName:x,style:f,size:O,labelStyle:w,contentStyle:N,styles:C,items:k,classNames:E}=e,z=B(e,["prefixCls","title","extra","column","colon","bordered","layout","children","className","rootClassName","style","size","labelStyle","contentStyle","styles","items","classNames"]),{getPrefixCls:I,direction:P,className:M,style:H,classNames:L,styles:W}=(0,d.TP)("descriptions"),T=I("descriptions",t),R=(0,b.A)();const F=n.useMemo(()=>{var e;return"number"===typeof c?c:null!==(e=(0,r.ko)(R,Object.assign(Object.assign({},p),c)))&&void 0!==e?e:3},[R,c]),G=g(R,k,u),V=(0,m.A)(O),X=y(F,G),[D,K,_]=A(T),q=n.useMemo(()=>({labelStyle:w,contentStyle:N,styles:{content:Object.assign(Object.assign({},W.content),null===C||void 0===C?void 0:C.content),label:Object.assign(Object.assign({},W.label),null===C||void 0===C?void 0:C.label)},classNames:{label:i()(L.label,null===E||void 0===E?void 0:E.label),content:i()(L.content,null===E||void 0===E?void 0:E.content)}}),[w,N,C,E,L,W]);return D(n.createElement(v.Provider,{value:q},n.createElement("div",Object.assign({className:i()(T,M,L.root,null===E||void 0===E?void 0:E.root,{["".concat(T,"-").concat(V)]:V&&"default"!==V,["".concat(T,"-bordered")]:!!s,["".concat(T,"-rtl")]:"rtl"===P},j,x,K,_),style:Object.assign(Object.assign(Object.assign(Object.assign({},H),W.root),null===C||void 0===C?void 0:C.root),f)},z),(l||a)&&n.createElement("div",{className:i()("".concat(T,"-header"),L.header,null===E||void 0===E?void 0:E.header),style:Object.assign(Object.assign({},W.header),null===C||void 0===C?void 0:C.header)},l&&n.createElement("div",{className:i()("".concat(T,"-title"),L.title,null===E||void 0===E?void 0:E.title),style:Object.assign(Object.assign({},W.title),null===C||void 0===C?void 0:C.title)},l),a&&n.createElement("div",{className:i()("".concat(T,"-extra"),L.extra,null===E||void 0===E?void 0:E.extra),style:Object.assign(Object.assign({},W.extra),null===C||void 0===C?void 0:C.extra)},a)),n.createElement("div",{className:"".concat(T,"-view")},n.createElement("table",null,n.createElement("tbody",null,X.map((e,t)=>n.createElement(S,{key:t,index:t,colon:o,prefixCls:T,vertical:"vertical"===h,bordered:s,row:e}))))))))};I.Item=x;const P=I;var M=l(6004),H=l(5369),L=l(8168);const W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};var T=l(5085),R=function(e,t){return n.createElement(T.A,(0,L.A)({},e,{ref:t,icon:W}))};const F=n.forwardRef(R);var G=l(4118),V=l(4513),X=l(4424),D=l(4414);const{TextArea:K}=a.A,_=e=>{let{visible:t,cell:l,onClose:a}=e;const{currentWorksheet:s}=(0,X.K)(),[i,r]=(0,n.useState)(!1),[d,m]=(0,n.useState)("");(0,n.useEffect)(()=>{l&&(m(String(l.value||"")),r(!1))},[l]);const b=(0,n.useCallback)(()=>{r(!0)},[]),p=(0,n.useCallback)(()=>{l&&s&&(c.Ay.success("\u4fdd\u5b58\u6210\u529f"),r(!1))},[l,s]),v=(0,n.useCallback)(()=>{m(String((null===l||void 0===l?void 0:l.value)||"")),r(!1)},[l]),h=(0,n.useCallback)(e=>{"Escape"===e.key?a():"Enter"===e.key&&e.ctrlKey&&p()},[a,p]);if(!l||!s)return null;const u=(()=>{var e,t,n,a;const{row:c,col:o}=l;return{top:null===(e=s.data[c-1])||void 0===e?void 0:e[o],bottom:null===(t=s.data[c+1])||void 0===t?void 0:t[o],left:null===(n=s.data[c])||void 0===n?void 0:n[o-1],right:null===(a=s.data[c])||void 0===a?void 0:a[o+1]}})();return(0,D.jsx)(o.A,{title:"\u5355\u5143\u683c\u8be6\u60c5 - ".concat(l.address),open:t,onCancel:a,width:800,footer:null,children:(0,D.jsxs)("div",{className:"cell-detail",onKeyDown:h,children:[(0,D.jsxs)(P,{title:"\u57fa\u672c\u4fe1\u606f",bordered:!0,size:"small",column:2,children:[(0,D.jsx)(P.Item,{label:"\u5730\u5740",children:l.address}),(0,D.jsx)(P.Item,{label:"\u884c",children:l.row+1}),(0,D.jsx)(P.Item,{label:"\u5217",children:l.col+1}),(0,D.jsx)(P.Item,{label:"\u7c7b\u578b",children:l.type}),(0,D.jsx)(P.Item,{label:"\u683c\u5f0f",span:2,children:l.format||"\u65e0"})]}),(0,D.jsxs)("div",{className:"cell-value-section",children:[(0,D.jsx)("h4",{children:"\u5355\u5143\u683c\u503c"}),i?(0,D.jsxs)("div",{className:"edit-mode",children:[(0,D.jsx)(K,{value:d,onChange:e=>m(e.target.value),rows:4,autoFocus:!0}),(0,D.jsxs)(M.A,{style:{marginTop:8},children:[(0,D.jsx)(H.Ay,{type:"primary",icon:(0,D.jsx)(F,{}),onClick:p,children:"\u4fdd\u5b58"}),(0,D.jsx)(H.Ay,{icon:(0,D.jsx)(G.A,{}),onClick:v,children:"\u53d6\u6d88"})]})]}):(0,D.jsxs)("div",{className:"view-mode",children:[(0,D.jsx)("div",{className:"value-display",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",minHeight:"40px",padding:"8px",backgroundColor:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",lineHeight:"1.4"},children:l.value||(0,D.jsx)("em",{children:"\u7a7a\u503c"})}),(0,D.jsx)(H.Ay,{type:"link",icon:(0,D.jsx)(V.A,{}),onClick:b,children:"\u7f16\u8f91"})]})]}),l.formula&&(0,D.jsxs)("div",{className:"formula-section",children:[(0,D.jsx)("h4",{children:"\u516c\u5f0f"}),(0,D.jsx)("div",{className:"formula-display",children:(0,D.jsx)("code",{children:l.formula})})]}),l.style&&(0,D.jsxs)("div",{className:"style-section",children:[(0,D.jsx)("h4",{children:"\u6837\u5f0f\u4fe1\u606f"}),(0,D.jsxs)(P,{size:"small",column:2,children:[l.style.font&&(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)(P.Item,{label:"\u5b57\u4f53",children:[l.style.font.bold&&"\u7c97\u4f53 ",l.style.font.italic&&"\u659c\u4f53 ",l.style.font.size&&"\u5927\u5c0f: ".concat(l.style.font.size),l.style.font.color&&" \u989c\u8272: ".concat(l.style.font.color)]})}),l.style.fill&&(0,D.jsx)(P.Item,{label:"\u586b\u5145\u8272",children:l.style.fill.color||"\u65e0"}),l.style.alignment&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(P.Item,{label:"\u6c34\u5e73\u5bf9\u9f50",children:l.style.alignment.horizontal||"\u9ed8\u8ba4"}),(0,D.jsx)(P.Item,{label:"\u5782\u76f4\u5bf9\u9f50",children:l.style.alignment.vertical||"\u9ed8\u8ba4"})]})]})]}),(0,D.jsxs)("div",{className:"adjacent-cells",children:[(0,D.jsx)("h4",{children:"\u76f8\u90bb\u5355\u5143\u683c"}),(0,D.jsxs)("div",{className:"adjacent-grid",children:[(0,D.jsx)("div",{className:"adjacent-cell empty"}),(0,D.jsx)("div",{className:"adjacent-cell",children:u.top?(0,D.jsxs)("div",{children:[(0,D.jsx)("div",{className:"cell-address",children:u.top.address}),(0,D.jsx)("div",{className:"cell-value",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",maxWidth:"100px",fontSize:"12px",lineHeight:"1.3"},children:u.top.value||"\u7a7a"})]}):(0,D.jsx)("div",{className:"no-cell",children:"\u65e0"})}),(0,D.jsx)("div",{className:"adjacent-cell empty"}),(0,D.jsx)("div",{className:"adjacent-cell",children:u.left?(0,D.jsxs)("div",{children:[(0,D.jsx)("div",{className:"cell-address",children:u.left.address}),(0,D.jsx)("div",{className:"cell-value",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",maxWidth:"100px",fontSize:"12px",lineHeight:"1.3"},children:u.left.value||"\u7a7a"})]}):(0,D.jsx)("div",{className:"no-cell",children:"\u65e0"})}),(0,D.jsxs)("div",{className:"adjacent-cell current",children:[(0,D.jsx)("div",{className:"cell-address",children:l.address}),(0,D.jsx)("div",{className:"cell-value",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",maxWidth:"100px",fontSize:"12px",fontWeight:"bold",lineHeight:"1.3"},children:l.value||"\u7a7a"})]}),(0,D.jsx)("div",{className:"adjacent-cell",children:u.right?(0,D.jsxs)("div",{children:[(0,D.jsx)("div",{className:"cell-address",children:u.right.address}),(0,D.jsx)("div",{className:"cell-value",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",maxWidth:"100px",fontSize:"12px",lineHeight:"1.3"},children:u.right.value||"\u7a7a"})]}):(0,D.jsx)("div",{className:"no-cell",children:"\u65e0"})}),(0,D.jsx)("div",{className:"adjacent-cell empty"}),(0,D.jsx)("div",{className:"adjacent-cell",children:u.bottom?(0,D.jsxs)("div",{children:[(0,D.jsx)("div",{className:"cell-address",children:u.bottom.address}),(0,D.jsx)("div",{className:"cell-value",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",maxWidth:"100px",fontSize:"12px",lineHeight:"1.3"},children:u.bottom.value||"\u7a7a"})]}):(0,D.jsx)("div",{className:"no-cell",children:"\u65e0"})}),(0,D.jsx)("div",{className:"adjacent-cell empty"})]})]}),(0,D.jsx)("div",{className:"keyboard-hints",children:(0,D.jsx)("small",{children:"\u5feb\u6377\u952e\uff1aESC \u5173\u95ed | Ctrl+Enter \u4fdd\u5b58"})})]})})}}}]);